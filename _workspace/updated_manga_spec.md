# ウェブ漫画リマインダー 仕様書

## 📋 プロジェクト概要

ユーザーが指定した周期で、指定したURLへのリンクをプッシュ通知するPWAアプリケーション。GitHub Pagesで公開し、PC/スマホ/タブレットで利用可能。

## 🎯 主要機能（実装済み）

### 基本機能
- **リマインダー管理**: 作成・編集・削除・一時停止・複製機能
- **柔軟な周期設定**: 毎日・数日ごと・毎週・特定曜日複数選択・毎月（第n曜日）
- **プッシュ通知**: 指定時刻にブラウザ通知（Service Worker）
- **タグ機能**: 分類・検索・フィルター対応
- **テーマ切り替え**: ライト/ダーク/システム準拠
- **PWA対応**: オフライン動作・インストール可能・ホーム画面追加
- **データ管理**: JSON エクスポート/インポート（重複処理含む）
- **タイムゾーン管理**: 移動時の自動検出・調整ダイアログ

### 通知仕様
- **タイミング**: 指定時刻ピッタリ
- **頻度**: 1回のみ（確認済み状態は実装しない）
- **制約**: ブラウザ未起動時は制限あり（PWAインストール推奨）
- **Service Worker**: 本番環境でのみ動作、定期チェック機能付き

### 周期設定詳細（実装済み）
- **毎日**: 指定時刻に毎日通知
- **数日ごと**: n日間隔での通知（2〜365日）
- **毎週○曜日**: 特定の曜日に通知
- **毎週☆曜日（複数）**: 複数の曜日を選択して通知
- **毎月第△週◇曜日**: 月の第n週の特定曜日に通知（第5週選択不可）

## 🏗️ 技術構成

### フロントエンド
- **React 18** + **TypeScript** + **Tailwind CSS**
- **Vite 4.4.0** (ビルドツール、npm依存関係管理)
- **PWA**: vite-plugin-pwa 0.16.0
- **アイコン**: Lucide React 0.263.1

### デプロイ・ホスティング
- **GitHub Pages**
- **GitHub Actions** (自動デプロイ)
- **ベースURL**: `./`（相対パス設定）

### データ管理
- **LocalStorage** (ユーザー登録なし)
- **Service Worker** (通知・オフライン対応)
- **カスタムフック**: useReminders, useSettings, useTheme, useTimezone

### 開発ツール（実装済み）
- **ESLint**: コード品質チェック
- **Prettier**: コードフォーマット
- **TypeScript**: 型安全性
- **http-server**: ローカルプレビュー

## 📱 ユーザー体験

### ダッシュボード（実装済み）
- **並び順**: 最終通知日時の新→古順
- **表示情報**: 最終通知日時・次回通知日時・タイトル・URL・タグ
- **検索・フィルター**: タイトル・URL・タグ・一時停止状態
- **操作**: 編集・削除・複製・一時停止・URL直接アクセス

### モバイル対応（実装済み）
- **レスポンシブデザイン**: Tailwind CSS
- **PWA機能**: マニフェスト・アイコン・ショートカット
- **インストール推奨**: 通知の安定性向上

### テーマ（実装済み）
- **ライトモード**
- **ダークモード**
- **システム準拠**: OS設定に自動追従

## 💾 データ管理（実装済み）

### エクスポート
- **ファイル名**: `web-manga-reminders-YYYY-MM-DD.json`
- **内容**: リマインダー・設定・テーマ・メタデータ（UserAgent、タイムゾーン）
- **バージョン**: 1.0.0形式

### インポート
- **重複判定**: URLの完全一致
- **重複処理**: ユーザー選択（上書き・スキップ・追加）
- **形式チェック**: JSON形式・型検証・エラーハンドリング
- **状態表示**: 成功・エラー表示

### バックアップ
- **推奨頻度**: UIで定期バックアップを案内
- **注意事項**: ブラウザキャッシュ削除で消失の可能性

## 🔔 通知システム（実装済み）

### 実装方式
- **Service Worker**: 本番環境のみ登録
- **通知許可**: 初回アクセス時にリクエスト
- **定期チェック**: 設定可能な間隔

### 許可・設定（実装済み）
- **通知許可**: ブラウザ通知API
- **チェック間隔**: 15分〜2時間（ユーザー設定可能）
- **バッテリー考慮**: 設定画面で消費量案内

### Service Worker詳細
- **キャッシュ戦略**: Workbox使用
- **オフライン対応**: 静的リソースキャッシュ
- **通知処理**: バックグラウンド実行

## ⏸️ 一時停止機能（実装済み）

### 目的
- **漫画休載中**の通知回避
- **個別制御**: リマインダーごとに個別設定

### 仕様
- **一時停止状態**: フラグ管理（isPaused）
- **UI表示**: 一時停止中の視覚的表示
- **再開機能**: ワンクリックで再開可能

## 🌍 タイムゾーン対応（実装済み）

### 基本方針
- **ユーザーの現在タイムゾーン**で動作
- **自動検出**: ブラウザAPIでタイムゾーン取得

### 移動時対応（実装済み）
- **自動検出**: 1時間ごとのタイムゾーンチェック
- **変更ダイアログ**: 影響するリマインダー表示
- **調整オプション**: 現地時刻維持・元時刻維持選択可能

## 🔧 技術的制約・注意事項

### ブラウザ制約
- **通知**: ブラウザ未起動時は制限
- **PWAインストール**: より安定した通知のため推奨
- **オフライン**: データ閲覧・編集可能

### アプリ更新（実装済み）
- **自動更新**: vite-plugin-pwa（registerType: 'autoUpdate'）
- **キャッシュクリア**: cleanupOutdatedCaches有効

### 開発制約
- **開発環境**: PWA機能無効（devOptions.enabled: false）
- **最小Node.js**: 18.0.0以上

## 📊 プロジェクト構造（実装済み）

```
src/
├── components/          # Reactコンポーネント
│   ├── Dashboard.tsx    # メインダッシュボード
│   ├── CreateReminder.tsx # リマインダー作成・編集
│   ├── Settings.tsx     # 設定画面
│   ├── ReminderCard.tsx # リマインダー表示カード
│   ├── TagFilter.tsx    # タグフィルター
│   ├── Header.tsx       # ヘッダーコンポーネント
│   └── TimezoneChangeDialog.tsx # タイムゾーン変更ダイアログ
├── hooks/              # カスタムフック
│   ├── useReminders.ts # リマインダー管理
│   ├── useSettings.ts  # 設定管理
│   ├── useTheme.ts     # テーマ管理
│   └── useTimezone.ts  # タイムゾーン管理
├── types/              # TypeScript型定義
│   └── index.ts
├── utils/              # ユーティリティ関数
│   └── helpers.ts
├── App.tsx             # メインアプリコンポーネント
├── main.tsx           # エントリーポイント
└── index.css          # グローバルスタイル
```

### PWA設定（実装済み）

#### Service Worker
- **本番環境のみ**: 開発時は無効化
- **Workbox**: キャッシュ戦略・オフライン対応
- **通知機能**: 定期チェック・バックグラウンド同期

#### マニフェスト
- **アプリ名**: 「ウェブ漫画リマインダー」
- **アイコン**: 72x72〜512x512（マスク対応）
- **ショートカット**: 新規作成・設定画面
- **スクリーンショット**: モバイル・デスクトップ
- **プロトコルハンドラー**: web+manga対応

## 📋 実装状況

### ✅ 完全実装済み
- **Phase 1**: 基本リマインダー管理・周期設定・通知機能・エクスポート/インポート
- **Phase 2**: タグ機能・検索・一時停止機能・テーマ切り替え・PWA最適化
- **追加実装**: 複製機能・タイムゾーン管理・設定画面の詳細設定

### 🚀 主要npmスクリプト（実装済み）

```bash
# 開発サーバー起動
npm run dev

# 本番ビルド
npm run build

# ビルド結果のプレビュー  
npm run preview

# 型チェック
npm run type-check

# ESLint実行
npm run lint

# ESLint自動修正
npm run lint:fix

# Prettier実行
npm run format

# 全チェック実行
npm run check:all

# 全チェック+自動修正
npm run check:fix
```

### 🔖 主要依存関係（実装済み）

**本番依存関係:**
- react: ^18.2.0
- react-dom: ^18.2.0  
- lucide-react: ^0.263.1

**開発依存関係:**
- vite: ^4.4.0
- vite-plugin-pwa: ^0.16.0
- typescript: ^5.0.2
- @vitejs/plugin-react: ^4.0.0
- eslint関連パッケージ
- prettier: ^3.0.0

## 🚀 デプロイ設定（実装済み）

### GitHub Pages
- **自動デプロイ**: GitHub Actions
- **ビルド設定**: Vite（dist出力）
- **ベースパス**: 相対パス（`./`）

### ビルド最適化
- **コード分割**: vendor・utilsチャンク
- **最小化**: terser使用
- **ソースマップ**: 本番では無効

---

## 🔮 今後の拡張可能性

### 優先度：高
- **外部プッシュ通知サービス**: より確実な通知のため（Web Push API等）
- **通知設定の詳細化**: 通知音・バイブレーション・表示時間等
- **UI/UXの改善**: ユーザビリティ向上・アクセシビリティ対応

### 優先度：中
- **QRコードエクスポート/インポート**: プライバシーを保ちつつ簡単にデータ移行
  - デバイス間でのデータ共有が手軽に
  - インターネット不要、完全オフライン動作
  - セキュリティ面でも安心
- **リマインダーテンプレート**: よく使用する設定の保存・再利用
- **通知内容のカスタマイズ**: メッセージテンプレート機能

### 優先度：検討中
- **複数デバイス間同期**: 利便性は高いが実装コストとの兼ね合い要検討
  - 簡易実装案：QRコードでの手動データ移行（上記機能で対応）
  - 本格実装案：クラウドストレージ連携（Google Drive API等）

### 技術的考慮事項
- **API拡張余地**: 型定義での将来対応を維持
- **パフォーマンス最適化**: 大量データ対応・メモリ使用量削減
- **セキュリティ強化**: データ暗号化・プライバシー保護
- **QR実装**: qrcode.js等の軽量ライブラリ活用

---

*最終更新: 2025-08-12*  
*実装状況: Phase 1-2 完全実装済み、追加機能含む*